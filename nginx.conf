server {
    listen 80;
    server_name localhost;

    # 1. Main Application Assets
    location / {
        root /usr/share/nginx/html;
        index index.html;
        try_files $uri $uri/ /index.html;
    }

    # 2. Liveness Probe
    # Confirms the container is running.
    location /healthz {
        access_log off;
        add_header 'Content-Type' 'text/plain';
        return 200 "OK";
    }

    # 3. Readiness Probe
    # Confirms the server is ready to accept traffic.
    location /readyz {
        access_log off;
        add_header 'Content-Type' 'text/plain';
        return 200 "OK";
    }

    # 4. Prometheus Metrics (stub_status)
    # This allows Prometheus or an exporter to see active connections and requests.
    location /metrics {
        stub_status on;
        access_log off;
        allow 127.0.0.1;   # Only allow local scraping (or your internal subnet)
        allow 10.0.0.0/8; # Typical K8s Pod CIDR range
        deny all;
    }
}